<!DOCTYPE html>
<html>

<head>
  <title>Hot Rod Remote Events #3: Customizing events</title>
  <!-- <script id="adobe_dtm" src="//www.redhat.com/dtm.js" type="text/javascript"></script> -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Infinispan is a distributed in-memory key/value data store with optional schema, available under the Apache License 2.0.">
  <link rel="shortcut icon" type="image/png" href="/infinispan/favicon.ico" >
  <link rel="stylesheet" href="/infinispan/assets/css/main.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <!-- Global site tag (gtag.js) - Google Analytics -->
<!--   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-125236544-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
 
    gtag('config', 'UA-125236544-1');
  </script> -->


</head>

<body class="blog">
  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
  <div class="container">
    <div class="logo-wrapper">
        <a href="/infinispan/"><img src="/infinispan/assets/images/infinispan-logo-white.png" class="project-logo" title="Infinispan Logo"></a>
    </div>
    <label class="nav-toggle" for="checkbox">
      <i class="fa fa-bars"></i>
    </label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/infinispan/learn/">Learn <i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/infinispan/introduction" class="">Introduction</a></li>
          <li><a href="/infinispan/features" class="">Features</a></li>
          <li><a href="/infinispan/documentation" class="">Documentation</a></li>
          <li><a href="/infinispan/tutorials" class="">Tutorials</a></li>
          <li><a href="/infinispan/videos" class="">Videos</a></li>
          <li><a href="/infinispan/references" class="">References</a></li>
          <li><a href="/infinispan/experiments" class="">Experiments</a></li>
          <li><a href="/infinispan/roadmap" class="">Roadmap</a></li>
        </ul>
      </li>
      <li>
        <a href="/infinispan/use-cases/" class="">Use Cases</a>
      </li>
      <li>
        <a href="/infinispan/community/" class="">Community</a>
      </li>
      <li>
        <a href="/infinispan/blog/" class="active">Blog</a>
      </li>
      <li>
        <a href="/infinispan/download/" class="">Download</a>
      </li>
    </ul>
  </div>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    <div class="component-slim full-width-bg dark-bg light-blue">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <a href="/infinispan/blog">Blogs</a> <i class="fas fa-chevron-right"></i> Hot Rod Remote Events #3: Customizing events
    </div>
  </div>
</div>
<div class="post-page grid-wrapper">
  <div class="grid__item width-10-12 width-12-12-m doc-content">
    <h1>Hot Rod Remote Events #3: Customizing events</h1>
    <div class="post-date">September 17, 2014
      Tags: <a href="/infinispan/blog/tag/ hotrod"> hotrod</a> <a href="/infinispan/blog/tag/event">event</a> <a href="/infinispan/blog/tag/remote events">remote events</a> 
    </div>
    <div class="grid-wrapper">
      <div class="grid__item width-8-12 width-12-12-m margin-tb-sm">
        <p class="byline">By Galder Zamarreño</p>
      </div>
      <div class="grid__item width-12-12">
          <div class="paragraph">
<p>This blog post is the third in a series that looks at the forthcoming
Hot Rod Remote Events functionality included in Infinispan 7.0. In the
<a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-1-getting-started.html">first
article</a> we looked at how to get started receiving remote events from
Hot Rod servers. In the
<a href="http://blog.infinispan.org/2014/08/hot-rod-remote-events-2-filtering-events.html">second
article</a>, we saw how Hot Rod remote events can be filtered providing
key/value filter factories that can create instances that filter which
events are sent to clients, and how these filters can act on client
provided information.</p>
</div>
<div class="paragraph">
<p>This time we are going to focus on how to customize events sent to
clients. Events generated by default contain just enough information to
make the event relevant but avoid cramming too much information in order
to reduce the cost of sending them. Normally, this information consists
of key and type of event.</p>
</div>
<div class="paragraph">
<p>Optionally, the information shipped in these events can be customized in
order to contain more information, such as values, or to contain even
less information. This customization is done
with org.infinispan.notifications.cachelistener.filter.CacheEventConverter
instances which are created by implementing
a org.infinispan.notifications.cachelistener.filter.CacheEventConverterFactory class.
Each factory must have a name associated to it via the
org.infinispan.filter.NamedFactory annotation.</p>
</div>
<div class="paragraph">
<p>When a listener is added, we can provide the name of a converter factory
to use with this listener, and when the listener is added, the server
will look up the factory and invoke getConverter method to get
a org.infinispan.notifications.cachelistener.filter.CacheEventConverter class
instance to customize events server side.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a sample implementation which will send custom events containing
value information back to clients for a cache of Integers and Strings:</p>
</div>
<div class="paragraph">
<p>In the example above, the converter generates a new custom event which
includes the value as well as the key in the event. This will result in
bigger event payloads compared with default events, but if combined with
filtering, it can reduce its network bandwidth cost.</p>
</div>
<div class="paragraph">
<p>In another converter implementation, the user could decide to send back
an event that contains no key or event type information. This would
result in extremely lightweight events at the expense of richness of
information provided by the event itself.</p>
</div>
<div class="paragraph">
<p>Plugging the server with this converter requires deploying this
converter factory (and associated converter class) within a jar file
including a service definition inside the
META-INF/services/org.infinispan.notifications.cachelistener.filter.CacheEventConverterFactory file:</p>
</div>
<div class="paragraph">
<p>With the server plugged with the converter, the next step is adding a
remote client listener that will use this converter. How to implement a
listener for custom events is slightly different to the listeners we&#8217;ve
seen in the last couple of blog posts because we know have to deal with
customised events as opposed to the default ones. To do so, the same
annotations are used as previous blog posts, but the callbacks receive
instances
of org.infinispan.client.hotrod.event.ClientCacheEntryCustomEvent&lt;T&gt;,
where T is the type of custom event we are sending from the server:</p>
</div>
<div class="paragraph">
<p>Now it&#8217;s time to write a simple main java class which adds the remote
event listener and executes some operations against the remote cache:</p>
</div>
<div class="paragraph">
<p>Once executed, we should see a console console output similar to this:</p>
</div>
<div class="paragraph">
<p>Similar to events, converters can also act on client provided
information, enabling converter instances to customize events depending
on the information given when the listener was added. The API provides
an extra parameter to pass in converter parameters when the listener is
added. Given the similarities with filtering, this part is not covered
by this blog post.</p>
</div>
<div class="paragraph">
<p>A final note on the marshalling aspects of this example. In order to
facilitate both server and client writing against type safe APIs, both
the client and server need to be aware of custom event type and be able
to marshall it. Client side, this is done by an optional marshaller
configurable via the RemoteCacheManager. Server side, this is done by a
marshaller recently added to the Hot Rod server configuration.</p>
</div>
<div class="paragraph">
<p>In the next blog post in the Hot Rod remote events series, we will look
at how to receive remote events in a clustered environment, how to deal
with failover situations&#8230;&#8203;etc.</p>
</div>
<div class="paragraph">
<p>Cheers,
Galder</p>
</div>
          
      </div>
    </div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/infinispan/"><img src="/infinispan/assets/images/infinispan-logo.png" class="project-logo" title="Infinispan Logo"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Infinispan is released under the Apache 2.0 open source license. Learn more about the <a href='LINK_NEEDED' target='_blank'>Apache Software License 2.0</a>.<br/><br/>This website built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a> is hosted on <a href='https://pages.github.com/' target='_blank'>Github Pages</a> and is completely open source. If you want to make it better, <a href='LINK_NEEDED' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <b>Navigation</b>
        <ul class="footer-links width-1-12">
          
            <li><a href="/">Home</a></li>
          
            <li><a href="/LINK_NEEDED">Features</a></li>
          
            <li><a href="/LINK_NEEDED">Docs</a></li>
          
            <li><a href="/LINK_NEEDED">Tutorials</a></li>
          
            <li><a href="/LINK_NEEDED">Videos</a></li>
          
            <li><a href="/LINK_NEEDED">Use Cases</a></li>
          
            <li><a href="/LINK_NEEDED">Community</a></li>
          
            <li><a href="/LINK_NEEDED">Download</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <b>Contribute</b>
        <ul class="footer-links width-1-12">
          
            <li><a href="https://issues.jboss.org/browse/ISPN">Submit a Bug</a></li>
          
            <li><a href="https://github.com/infinispan">Write Code</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <b>Follow Us</b>
        <ul class="footer-links width-1-12">
          
            <li><a href="/LINK_NEEDED">Blog</a></li>
          
            <li><a href="https://twitter.com/infinispan">Twitter</a></li>
          
        </ul>
      </div>
    

    <div class="width-6-12 more-links">
      <div class="grid-wrapper">
        <div class="width-6-12">
          <b>A Member of</b><br/>

          <a href="LINK_NEEDED" target="_blank"><img src="/infinispan/assets/images/footer/leads.png">
          </a>
          <a href="LINK_NEEDED" target="_blank"><img src="/infinispan/assets/images/footer/cloud-tm.png"></a>
          <br/>
          <a href="LINK_NEEDED" target="_blank"><img src="/infinispan/assets/images/footer/cloud-button.png"></a>

        </div>
        <div class="width-6-12">

          <b>Thanks to</b><br/>
          <a href="LINK_NEEDED" target="_blank">JetBrains Intellj IDEA</a><br/>
          <a href="LINK_NEEDED" target="_blank"><img src="/infinispan/assets/images/footer/jetbrains.png">
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
  <div class="content-slim redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a>
      | <a href="https://www.redhat.com/en/about/privacy-policy">Red Hat Privacy Policy</a>
    </span>
    <span class="redhat">
      a Red Hat sponsored project   
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/infinispan/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script type="text/javascript" src="/infinispan/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/infinispan/assets/javascript/truncate-list.js"></script>

<!--   <script type="text/javascript">
    if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
        _satellite.pageBottom();
    }
  </script> -->
</body>

</html>
